<script type="text/javascript">
  function selectDeselectAll(selectAllCheckbox) {
      $("input:checkbox[name*='selected_ids']").each(function (index, selectCheckbox) {
         if (selectAllCheckbox.checked) {
             selectCheckbox.checked=true;
         } else {
             selectCheckbox.checked=false;
         }
      });
  }
</script>

<% if @authenticated %>
    <h1>Disbursement Records</h1>
    <%= form_tag("/disbursement_records/show", :method => "post", :onsubmit => "setHiddenInput();") do %>
        <%= submit_tag("Show Selected") %>
        <table>
          <thead>
            <th><input type="checkbox" name="select_all" onclick="selectDeselectAll(this);" ></th>
            <th>Name</th>
            <th>Organization Name</th>
            <th>Date Created</th>
            <th>Created By</th>
          </thead>
          <tbody>
            <% @disbursement_records.each do |disbursement_record| %>
                <tr>
                  <td><%= check_box_tag "selected_ids[]", disbursement_record.Id, false, :id => disbursement_record.Id %></td>
                  <td><%= disbursement_record.Name %></td>
                  <td><%= disbursement_record.OrganizationName__c %></td>
                  <td><%= Time.parse(disbursement_record.CreatedDate).localtime.strftime("%-m/%-d/%Y") %></td>
                  <td><%= disbursement_record.CreatedBy.Name %></td>
                </tr>
            <% end %>
          </tbody>
        </table>
        <%= hidden_field_tag "pdf", true %>
    <% end %>
<% else %>
    You're not logged in. Click <a href="/auth/salesforce">here</a> to login.
<% end %>
